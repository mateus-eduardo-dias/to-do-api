# TODO API

## About
A REST API made with Node.Js, Express and Postgres. This API let users create TODO lists and has login features, with all data being saved in a postgres database

## Installation and Usage
If you want to implement this code on your project, you should create a `.env` file in the root directory with 3 variables: `JWT_AUTH_KEY` for the private key of the JWT Auth Token, `JWT_ISS` for the Issuer of the JWT Token and `DB_CONNSTR` for the Postgres database connection string

### Example
```env
JWT_AUTH_KEY="xxx"
JWT_ISS="xxx"
DB_CONNSTR="postgresql://xxx"
```

The database should have the table `users` and `todo`
- The users database should have the columns `id` for user id (PK), `username`, `method` (which does nothing for now) and `password`
- The todo database should have the columns `todo_id` (PK), `user_id` (FK), `name`, `description` and `status`

## API Endpoints

This section will be divided in Authentication Endpoints and Task Endpoints

### Authentication Endpoints

`POST /auth - Register a account`

Body:
```json
{
    "username": "xxx",
    "password": "xxx"
}
```

Response expected:
```json
{
    "status": "success",
    "code": 201,
    "info": 
    {
        "token": "<JWT Token generated by the authentication>"
    }
}
```
Creates a account for the user and returns a Auth Token

`GET /auth - Log into a account`

Body:
```json
{
    "username": "xxx",
    "password": "xxx"
}
```

Response expected:
```json
{
    "status": "success",
    "code": 200,
    "info": 
    {
        "token": "<JWT Token generated by the authentication>"
    }
}
```
Logs into a existing account with the same username and password, then returns a Auth Token

### Task Endpoints

#### Create

`POST /task - Creates a task`

Body:
```json
{
    "name": "xxx",
    "description": "<optional>"
}
```

Headers:
`Authorization: Bearer xxx`

Response expected:
```json
{
    "status": "success",
    "code": 201,
    "info": null
}
```
Creates a task with a name and maybe a description, it needs a Auth Token. 

#### Read

`GET /task - Get all tasks`

Headers:
`Authorization: Bearer xxx`

Response example:
```json
{
  "status": "success",
  "code": 200,
  "info": {
    "tasks": [
      {
        "todo_id": 1,
        "name": "myTask",
        "description": "my first task",
        "status": 0
      },
      {
        "todo_id": 2,
        "name": "myTask2",
        "description": "my seconds task",
        "status": 0
      }
    ]
  }
}
```
Get all tasks, it needs a Auth Token.


#### Update

`PUT /task - Updates a task`

Body:
```json
{
    "id": 123,
    "field": "[name/description/status]",
    "new_value": "xxx/123"
}
```

Headers:
`Authorization: Bearer xxx`

Response expected:
```json
{
    "status": "success",
    "code": 201,
    "info": null
}
```
Updates the name/description/status of a task, it needs a Auth Token. 

#### Delete

`DELETE /task - Deletes a task`

Body:
```json
{
    "id": 123
}
```

Headers:
`Authorization: Bearer xxx`

Response expected:
```json
{
    "status": "success",
    "code": 201,
    "info": null
}
```
Deletes a task by it's todo_id, it needs a Auth Token. 

## Owners

Mateus Eduardo